<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="payrun_report_template">
            <t t-call="web.html_container">
                <div class="article basic_layout">
                    <div class="text-center">
                        <h3>
                            <t t-esc="docs.company_id.display_name"/>
                        </h3>
                        <h4>
                            PAYRUN REPORT
                        </h4>
                        <h5>
                            Period: <t t-esc="data.get('report_start')"/> - <t t-esc="data.get('report_end')"/>
                        </h5>
                        <h5>
                            Generated By: <t t-esc="data.get('name')"/>
                            On: <t t-esc="date_time.get('date')"/>
                            At: <t t-esc="date_time.get('time')"/>
                        </h5>
                        <hr/>
                    </div>
                    <div class="full-width">
                        <table width="100%" class="text-center">
                            <tr>
                                <th>
                                    <span>ID</span>
                                </th>
                                <th>
                                    <span>Employee</span>
                                </th>
                                <th>
                                    <span>Date</span>
                                </th>
                                <th>
                                    <span>Rate</span>
                                </th>
                                <th>
                                    <span>Hours</span>
                                </th>
                                <th>
                                    <span>Basic</span>
                                </th>
                                <th>
                                    <span>OT/Jobs</span>
                                </th>
                                <th>
                                    <span>Allowance</span>
                                </th>
                                <th>
                                    <span>Gross</span>
                                </th>
                                <th>
                                    <span>Deductions</span>
                                </th>
                                <th>
                                    <span>Loans</span>
                                </th>
                                <th>
                                    <span>NIS</span>
                                </th>
                                <th>
                                    <span>HSUR</span>
                                </th>
                                <th>
                                    <span>PAYE</span>
                                </th>
                                <th>
                                    <span>Total Deductions</span>
                                </th>
                                <th>
                                    <span>Net</span>
                                </th>
                            </tr>
                            <tbody>
                                <t t-foreach="docs" t-as="payslip">
                                    <tr>
                                        <t t-set="empty_value">&#32;</t>
                                        <td>
                                            <t t-set="employee_id" t-value="empty_value" />
                                            <t t-if="payslip.employee_id.barcode != False" t-set="employee_id" t-value="payslip.employee_id.barcode"/>
                                            <span><t t-esc="employee_id"/></span>
                                        </td>
                                        <td>
                                            <span><t t-esc="payslip.employee_id.name"/></span>
                                        </td>
                                        <td>
                                            <span><t t-esc="payslip.date_to"/></span>
                                        </td>
                                        <td>
                                            <span><t t-esc="'{:,.2f}'.format(payslip.contract_id.wage)"/></span>
                                        </td>
                                        <td>
                                            <span><t t-esc="payslip.sum_worked_hours"/></span>
                                        </td>
                                        <t>
                                            <t t-set="default_value" t-value="0"/>
                                            <t t-set="basic" t-value="default_value" />
                                            <t t-set="ot" t-value="default_value" />
                                            <t t-set="allowance" t-value="default_value" />
                                            <t t-set="gross" t-value="default_value" />
                                            <t t-set="deductions" t-value="default_value" />
                                            <t t-set="loans" t-value="default_value" />
                                            <t t-set="nis" t-value="default_value" />
                                            <t t-set="hsur" t-value="default_value" />
                                            <t t-set="paye" t-value="default_value" />
                                            <t t-set="total_deductions" t-value="default_value" />
                                            <t t-set="net" t-value="default_value" />
                                        </t>

                                        <t t-set="line_ids" t-value="payslip.line_ids"/>
                                        <t t-foreach="line_ids" t-as="line">
                
                                            <t t-if="line.code == 'BASIC'"><t t-set="basic" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'OT'"><t t-set="ot" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'ADD'"><t t-set="allowance" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'GROSS'"><t t-set="gross" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'DED'"><t t-set="deductions" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'LOANS'"><t t-set="loans" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'NIS'"><t t-set="nis" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'HSUR'"><t t-set="hsur" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'PAYE'"><t t-set="paye" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'T_DED'"><t t-set="total_deductions" t-value="float(line.amount)"/></t>
                                            <t t-if="line.code == 'NET'"><t t-set="net" t-value="float(line.amount)"/></t>
                                        </t>
                                        <t>
                                            <t t-set="total_deductions" t-value="float(nis)+float(hsur)+float(paye)"/>
                                            <t t-set="total_deductions" t-value="round(total_deductions,2)"/>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(basic)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(ot)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(allowance)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(gross)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(deductions)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(loans)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(nis)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(hsur)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(paye)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(total_deductions)"/></span></td>
                                            <td t-attf-style="white-space:nowrap;"><span><t t-esc="'{:,.2f}'.format(net)"/></span></td>
                                        </t>
                                    </tr>
                                </t>
                            </tbody>
                            <hr style="border-top: 0.5px solid black;"/>
                            <td t-attf-style="white-space:nowrap;"><span></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="docs.company_id.display_name"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span></span></td>
                            <td t-attf-style="white-space:nowrap;"><span></span></td>
                            <td t-attf-style="white-space:nowrap;"><span></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('basic'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('ot'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('additions'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('gross'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('other_ded'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('loans'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('nis'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('hsur'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('paye'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('total_deductions'))"/></b></span></td>
                            <td t-attf-style="white-space:nowrap;"><span><b><t t-esc="'{:,.2f}'.format(totals.get('net'))"/></b></span></td>
                        </table>
                        <hr style="border-top: 2px solid black;"/>
                        <span>
                            <b>
                                <t>Total Employees: </t>
                                <t t-esc="totals.get('employees')"/>
                            </b>
                        </span>
                        <!-- <hr style="border-top: 2px solid black;"/>
                        <div class="row">
                            <div class="col-2">
                                <span>Prepared By: </span>
                            </div>
                            <div class="col-3" style="border-bottom:2px;"/>
                            <div class="col-2">
                                <span>Date: </span>
                            </div>
                            <div class="col-3" style="border-bottom:2px;"/>
                        </div>
                        <div class="row">
                            <div class="col-2">
                                <span>Verified By: </span>
                            </div>
                            <div class="col-3" style="border-bottom:2px;"/>
                            <div class="col-2">
                                <span>Date: </span>
                            </div>
                            <div class="col-3" style="border-bottom:2px;"/>
                        </div>
                        <div class="row">
                            <div class="col-2">
                                <span>Approved By 1: </span>
                            </div>
                            <div class="col-3" style="border-bottom:2px;"/>
                            <div class="col-2">
                                <span>Date: </span>
                            </div>
                            <div class="col" style="border-bottom:2px;"/>
                        </div>
                        <div class="row">
                            <div class="col-2">
                                <span>Approved By 2: </span>
                            </div>
                            <div class="col-3" style="border-bottom:2px;"/>
                            <div class="col-2">
                                <span>Date: </span>
                            </div>
                            <div class="col-3" style="border-bottom:2px;"/>
                        </div> -->
                        <hr style="border-top: 4px solid black;"/>
                    </div>
                </div>
            </t>
        </template>
    </data>
</odoo>